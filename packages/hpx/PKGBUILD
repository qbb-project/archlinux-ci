# Maintainer: Christopher Hinz <hinz@theo-physik.uni-kiel.de>

pkgname=hpx-dev

pkgver=1.0.0

pkgrel=1

pkgdesc="A general purpose C++ runtime system for parallel and distributed applications of any scale"

arch=('i686' 'x86_64')

url="http://stellar.cct.lsu.edu/"

license=('custom')

groups=()

depends=('boost>=1.57.0' 'hwloc>=1.10' 'jemalloc>=2.1.2' 'openmpi>=1.10.0' 'vc')

makedepends=('cmake>=2.8.4')

options=('staticlibs')

source=("git+https://github.com/STEllAR-GROUP/hpx.git")

md5sums=("SKIP")

provides=("hpx==1.0.0")
conflicts=("hpx-git" "hpx")

build() {
  cd "$srcdir/hpx"

  install -d build/
  cd build

  cmake -DCMAKE_BUILD_TYPE=Release              \
        -DHPX_WITH_PARCELPORT_MPI=ON              \
        -DHPX_WITH_MALLOC=JEMALLOC               \
        -DHPX_WITH_DATAPAR_VC=ON                  \
        -DHPX_WITH_EXAMPLES=OFF                  \
        -DHPX_WITH_TESTS=OFF                     \
        -DCMAKE_INSTALL_PREFIX=/usr    \
        ..

  make
}

package() {
  cd "$srcdir/hpx/build"

  make DESTDIR="$pkgdir/" install
}
